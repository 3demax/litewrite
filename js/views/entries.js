define(["require","jquery","underscore","backbone","text!templates/entries.html","collections/docs","models/settings"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("text!templates/entries.html"),s=e("collections/docs"),o=e("models/settings"),u=r.View.extend({el:"#entries",initialize:function(){this.template=n.template(i),s.deferred.done(n.bind(this.render,this)),s.on("reset",this.render,this).on("change:title",this.updateTitle,this).on("destroy",this.removeItem,this),o.on("change:openDocId",this.selectOpenDoc,this)},render:function(){this.$el.html(this.template({docs:s.filter(function(e){return!e.isEmpty()}).map(function(e){var t=e.toJSON();return t.opacity=e.getOpacity(),t})})),this.selectOpenDoc()},$itemById:function(e){return this.$(".item[data-id="+e+"]")},updateTitle:function(e){var t=this.$itemById(e.id).find("a");t.length&&!e.isEmpty()?t.html(e.get("title")):this.render()},removeItem:function(e){this.$itemById(e.id).remove()},selectOpenDoc:function(){this.$selected&&this.$selected.removeClass("selected"),this.$selected=this.$itemById(o.get("openDocId")).addClass("selected")},events:{"click .item":"openDoc"},openDoc:function(e){e.preventDefault(),t("#menu-button").removeClass("hide"),o.save("openDocId",this.$(e.currentTarget).attr("data-id"))}});return u})