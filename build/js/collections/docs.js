define(["require","jquery","underscore","backbone","localstorage","docModel"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("localstorage"),s=e("docModel"),o=r.Collection.extend({model:s,localStorage:new i("docsCollection"),initialize:function(e){this.on("change:content",function(e){var t=e.get("content").match(/(?=<br>)|<div>(.*?)<|.+?(?=<|$)/),r=n.isUndefined(t[1])?t[0]:t[1];e.save("title",r)}),this.fetch({success:n.bind(function(){this.isEmpty()&&this.addNew()},this)})},addNew:function(){this.create({id:n.uniqueId("doc_")})}});return new o})