define(["require","appView","docs","cache","settings"],function(e){function s(){r.openDoc=n.get(i.get("openDocId"))}function o(){document.title="Litewrite: "+r.openDoc.get("title")}function u(){s(),i.on("change:openDocId",function(){s(),o();var e=n.get(i.previous("openDocId"));e.save("content",$.trim(e.get("content"))),_.isEmpty(e.get("content"))&&e.destroy()}),n.on("change:title",o),o(),n.on("add",function(e){i.save("openDocId",e.id)}),$(function(){new t})}var t=e("appView"),n=e("docs"),r=e("cache"),i=e("settings");return u})